#   解决方案

>   使用 MySql 作为数据库服务器

从Java的角度看，MySql是一个存放数据的地方。

从MySql的角度看，Java是一种客户端，使用部分功能

### 搭建运行环境

1.  MySql 服务器

本地安装或云上运行的 MySql 服务器

使用某种MySql服务器的客户端连接，并且成功

2.  下载 Java版的MySql驱动包加入项目

3.  记录连接MySql服务器时使用的信息：地址、端口、用户名和密码

客户端连接MySql服务器的信息同样在 Java 里需要。

### JDBC 主要特点

-   JDBC操作是从数据库连接开始，然后才能进行各种操作
-   JDBC操作流程是固定，具备模板模式
-   JDBC主要操作分类
    -   执行SQL语句
    -   获取数据库元数据

对于主要操作，可以通过接口屏蔽掉，定义一个对象把数据库连接和对应的操作给封装起来，暴露出来的可能就是一个个方法，这些方法表明了它的操作具备的功能。

数据库服务器接收可执行SQL语句，然后返回响应数据。

执行SQL语句操作，需要请求参数、原始SQL语句、响应对象，这是变化部分，可以使用一个对象包装起来。执行SQL语句，根据请求参数加上传入的原始SQL得到，响应数据是根据操作确定，从JDBC对象到自定义数据类，需要转换。

可以通过动态代理，把各种业务操作调用重定向到JDBC语法方法，也就回到了JDBC操作流程上来了。

### 数据库事务

数据库事务是由数据库服务器支持实现的，向客户端提供接口。

所有遵循 JDBC 规范的驱动程序都需要提供事务支持，JDBC API 中的事务管理符合SQL：2003规范，主要包含：自动提交模型、事务隔离级别、保存点

在JDBC里，事务是与连接一起，只有提交了事务，执行的SQL语句才会起作用，SQL语句数据执行即读写，对应到SQL语句操作，读只有查询，写有新增、删除、修改三个操作。

不知道，事务与连接是不是一对一的关系，不过，好像没有关系，事务是逻辑上的，连接是物理上的，也许一个连接可以发送多个事务。

这个连接是建立在TCP网络请求上的，那么提交事务是不是就是使用TCP向服务器发送数据了？

事务执行主要有三个阶段：执行之前、执行期间、执行之后，执行结果只有两个：成功、失败，成功了就把数据变更并且不可逆，失败就回复原状，什么都没发生过。

事务里可以包含多条SQL语句，但是他们是一个整体，不可分割，一个执行单元，也就是原子性。

事务执行成功之后，即使发生异常，数据也不会变化，这就是持久性。

为了对应多个请求同时读写数据，需要一种方法来应对这种并发，这就是隔离性，看起来很像并发里的安全性问题，写改变共享数据，读到的数据，可能不具备时效性。查询操作在写处理之前，这时数据变化了；查询操作在写处理之后但是事务失败了，这时数据就不准确了。

数据从当前状态到另外状态也要保持一致，这就是一致性。

事务开启，表示后面添加的SQL是这个执行单元一部分，事务提交，表示后续没有SQL语句提交了，从开启到提交期间出现的SQL语句就是此次的任务作业。不过，这个过程中还可以开启子事务，也就是嵌套事务，父事务和子事务是否是一个大的事务呢？或者说互不影响，或者说子事务影响父事务？

在JDBC里能够体现事务的也就是设置连接的属性和连接的提交方法。

----



# mybatis 概述

MyBatis 是一种ORM框架，完成Java对象和数据库数据半自动化映射转换。

##  ORM 框架

-   JDBC
ORM 框架出现的主要原因是 JDBC 步骤里的第5步，响应结果，自动转换不太容易

CRUD 里，步骤 1--4、6 是固定的，这些重复性代码可以封装起来。

因为是基于JDBC，所以就得遵守它的规则，虽然可以刻意隐藏他，但是，必须正面对待他

-   面向开发人员

开发人员使用面向对象的思维实现业务逻辑，但数据库表设计是关系型模式思考文件，应用程序与关系型数据库之间交互时，数据在对象和关系结构中的表、列和字段之间进行转换

因为需要与数据库对接，所以必须需要JDBC，但是在应用里不想看到JDBC的身影，仅使用SQL语句就能实现逻辑，这样很好啊，还有个问题要解决，数据在Java和数据库里不同的载体。

[ORM-功能](https://www.processon.com/view/link/5e912ec31e085369d0b82691)，只暴露简单的API供开发人员使用。

-   SQL语句

数据库里操作数据需要SQL语句，Java里没有，但是，Java可以发送SQL语句来操作数据库数据，因此SQL语句管理是个问题

当把SQL语句看作是逻辑时，延伸出来另外一个问题是，SQL语句怎么与Java类方法无缝集成


##  背景

-   出现原因

JDBC 属于较底层原生API，并不适合直接在应用里面使用

-   主要优势
    -   sql语句集中管理与方法绑定
    -   sql语句请求参数和响应结果自动转换
    -   封装JDBC API，消除固定代码，简化SQL语句处理，提供一致性的接口
    -   数据库优化的手段之一是SQL语句
-   主要技术：
    -   JDBC
    -   解析XML
    -   反射
    -   动态代理

----


2.  业务流程

执行 SQL 语句，完成JDBC的流程。

- 初始化

实现各种配置或参数在系统里作为数据对象存在，作为数据支撑保证

对MapperConfig.xml、Mapper.xml等文件解析，或者接口扫描，目的是提取数据并保存到 Configuration 对象里，是MyBatis逻辑执行唯一数据来源，主要分为两类：全局参数和sql语句

以SQL语句为单位，关联执行相关对象，构建SQL语句，映射Java接口对象

- SQL执行

基于JDBC流程，但是把各个环节封装，Java对象与SQL字段映射，并且提供了一定的扩展

3.  一步一步

- 初始化

解析 MapperConfig.xml -> Mapper.xml -> Configuration

- SQL执行

SQL语句节点信息与Java接口方法是对应：输入参数、实际执行SQL语句、响应对象

输入参数需要转换，实际执行SQL语句可能动态拼接、响应对象需要转换

响应对象：获取SQL查询字段、对应类元数据、创建对象并设置值

生成代理执行对象

